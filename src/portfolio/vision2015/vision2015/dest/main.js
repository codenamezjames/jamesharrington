////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//     _    ____  ____     ____  ____   ___  _   _ ____   ___  ____     ___ __  __    _    ____ _____ ____     _   _ _____ ____  _____    //
//    / \  |  _ \|  _ \   / ___||  _ \ / _ \| \ | / ___| / _ \|  _ \   |_ _|  \/  |  / \  / ___| ____/ ___|   | | | | ____|  _ \| ____|   //
//   / _ \ | | | | | | |  \___ \| |_) | | | |  \| \___ \| | | | |_) |   | || |\/| | / _ \| |  _|  _| \___ \   | |_| |  _| | |_) |  _|     //
//  / ___ \| |_| | |_| |   ___) |  __/| |_| | |\  |___) | |_| |  _ <    | || |  | |/ ___ \ |_| | |___ ___) |  |  _  | |___|  _ <| |___    //
// /_/   \_\____/|____/   |____/|_|    \___/|_| \_|____/ \___/|_| \_\  |___|_|  |_/_/   \_\____|_____|____/   |_| |_|_____|_| \_\_____|   //
//                                                                                                                                        //
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// If a sponsor has both text and image it will favor the image
SPONSORS = [
//{img:'LINKTOIMAGE',             sponsorUrl:'http://link.com' underText:'lorem', sponsorLevel:1}
//{text:'THIS IS A TEXT SPONSOR', sponsorUrl:'http://link.com',                   sponsorLevel:4},
  {text:'Aerotek', sponsorUrl:'http://www.aerotek.com',                       sponsorLevel:4},
  {text:'Combined Insurance Services', sponsorUrl:'http://www.ciscompanies.com', sponsorLevel:4},
  {text:'Distinctively De Photography', sponsorUrl:'http://www.distinctivelyde.com',  sponsorLevel:4},
  {text:'Edwards Roofing', sponsorUrl:'http://www.edwardsroofing.com',        sponsorLevel:4},
  {text:'Emerald Coast Chapter MGMA', sponsorUrl:'http://www.ecmgma.com/',    sponsorLevel:4},
  {text:'Great Circle Shipping Corporation', sponsorUrl:'http://www.greatcircleship.com',  sponsorLevel:4},
  {text:'John S. Carr', sponsorUrl:'http://www.johnscarr.com',                sponsorLevel:4},
  {text:'Manpower', sponsorUrl:'http://www.manpower.com',                     sponsorLevel:4},
  {text:'Mansfield Industrial', sponsorUrl:'http://www.mansfieldindustrial.com', sponsorLevel:4},
  {text:'McBride Construction', sponsorUrl:'http://www.mcbride-construction.com', sponsorLevel:4},
  {text:'Moore, Hill & Westmoreland, P.A.', sponsorUrl:'http://www.mhw-law.com', sponsorLevel:4},
  {text:'ActiGraph', sponsorUrl:'http://www.theactigraph.com',                sponsorLevel:4},
  {text:'Appleyard Agency', sponsorUrl:'http://www.appleyardagency.com',             sponsorLevel:4},
  {text:'Ballinger Publishing', sponsorUrl:'http://www.ballingerpublishing.com', sponsorLevel:4},
  {text:'Bank of America', sponsorUrl:'http://www.bankofamerica.com',         sponsorLevel:4},
  {text:'Baroco Electric',                                                    sponsorLevel:4},
  {text:'BB&T', sponsorUrl:'http://www.bbt.com',                              sponsorLevel:4},
  {text:'Bell Steel ', sponsorUrl:'http://www.bellsteel.com',                 sponsorLevel:4},
  {text:'Blab Television Network', sponsorUrl:'http://blabtv.com',             sponsorLevel:4},
  {text:'Copy Products Company', sponsorUrl:'http://www.copyproductscompany.com', sponsorLevel:4},
  {text:'Covenant Hospice', sponsorUrl:'http://www.covenanthospice.org',      sponsorLevel:4},
  {text:'Edward Jones - John Peacock, CFP', sponsorUrl:'http://www.edwardjones.com', sponsorLevel:4},
  {text:'Electronic Display Networks', sponsorUrl:'http://www.edncorp.net',   sponsorLevel:4},
  {text:'Emmanuel Sheppard & Condon', sponsorUrl:'http://www.esclaw.com',     sponsorLevel:4},
  {text:'Engineered Cooling Services', sponsorUrl:'http://www.engineeredcooling.com', sponsorLevel:4},
  {text:'Fisher Brown Bottrell Insurance, Inc.', sponsorUrl:'http://www.fbbins.com', sponsorLevel:4},
  {text:'Florida First Capital Finance Corporation', sponsorUrl:'http://www.ffcfc.com', sponsorLevel:4},
  {text:'Gulf Coast Health Care', sponsorUrl:'http://www.gulfcoasthealthcare.com', sponsorLevel:4},
  {text:'Gulf Coast Office Products', sponsorUrl:'http://www.GCOP.com',       sponsorLevel:4},
  {text:'H2 Performance Consulting', sponsorUrl:'http://www.h2pc.com',        sponsorLevel:4},
  {text:'Hatch Mott MacDonald', sponsorUrl:'http://www.hatchmott.com',        sponsorLevel:4},
  {text:'Homebuilders Association of West Florida', sponsorUrl:'http://www.westfloridabuilders.com', sponsorLevel:4},
  {text:'J.W. Renfroe Pecan Company', sponsorUrl:'http://www.renfroepecan.com', sponsorLevel:4},
  {text:'McMahon & Hadder Insurance', sponsorUrl:'http://www.quotepensacola.com', sponsorLevel:4},
  {text:'NAI Halford', sponsorUrl:'http://www.naihalford.com',                sponsorLevel:4},
  {text:'New World Landing', sponsorUrl:'http://www.newworldlanding.com',     sponsorLevel:4},
  {text:'Portofino Island Resort & Spa', sponsorUrl:'http://www.portofinoisland.com', sponsorLevel:4},
  {text:'Rodney Rich & Co.', sponsorUrl:'http://www.rodneyrichco.com',        sponsorLevel:4},
  {text:'Rosie O&lsquo;Gradys, Inc.', sponsorUrl:'http://www.rosies.com',     sponsorLevel:4},
  {text:'Servis 1st Bank', sponsorUrl:'http://www.servisfirstbank.com',       sponsorLevel:4},
  {text:'Terracon', sponsorUrl:'http://www.terracon.com',                     sponsorLevel:4},
  {text:'WEAR -TV - Sinclair Broadcast Group, Inc.', sponsorUrl:'http://www.weartv.com', sponsorLevel:4},

  {img:'allen_turner_hyundai.png', sponsorUrl:'http://www.allenturnerauto.com', sponsorLevel:3},
  {img:'atkins_2925blue.png', sponsorUrl:'http://www.atkinsglobal.com',       sponsorLevel:3},
  {img:'bbva_compass.png', sponsorUrl:'http://www.bbvacompass.com',           sponsorLevel:3},
  // {img:'beck_logo_2.png',                                                     sponsorLevel:3},
  {img:'beck_logo.png', sponsorUrl:'http://www.teambeck.com',                 sponsorLevel:3},
  {img:'carver-darden.png', sponsorUrl:'http://www.carverdarden.com',         sponsorLevel:3},
  {img:'expressemploymentprofessionals_3color.png', sponsorUrl:'http://expresspensacola.com/', sponsorLevel:3},
  {img:'hixardt.png', sponsorUrl:'http://www.hixardt.com',                    sponsorLevel:3},
  {img:'kinematiclogo-black-transparent.png', sponsorUrl:'http://www.kinematicentertainment.com', sponsorLevel:3},
  {img:'perdidokeychamber.png', sponsorUrl:'http://www.perdidochamber.com',   sponsorLevel:3},
  {img:'total-employee-leasing-[converted].png', sponsorUrl:'http://www.totallc.com', sponsorLevel:3},
  {img:'whibbs_new_logo_group_2014.png', sponsorUrl:'http://www.vincewhibbs.com', sponsorLevel:3},

  {img:'ascend_horizontal.png', sponsorUrl:'http://www.ascendmaterials.com',  sponsorLevel:2},
  {img:'clark-partington-hart-larry-bond-&-stackhouse-vertical.png', sponsorUrl:'http://www.cphlaw.com', sponsorLevel:2},
  {img:'galloway-johnson-thompkins-burr-&-smith.png', sponsorUrl:'http://www.gjtbs.com', sponsorLevel:2},
  {img:'goldringgulflogo.png', sponsorUrl:'http://www.goldringgulf.com',      sponsorLevel:2},
  {img:'innisfree.png', sponsorUrl:'http://www.innisfree.com',                sponsorLevel:2},
  {img:'jerry_pate_company_straight.png', sponsorUrl:'http://www.jerrypate.com', sponsorLevel:2},
  {img:'navyfederal_pms540.png', sponsorUrl:'http://www.navyfederal.org',     sponsorLevel:2},
  // {img:'navyfederal_rev.png',                                                 sponsorLevel:3},
  {img:'pnj-tall.png', sponsorUrl:'http://www.pnj.com',                       sponsorLevel:2},
  {img:'regions-bank.png', sponsorUrl:'http://www.regions.com',               sponsorLevel:2},
  {img:'studergroup_huron_final_logo.png', sponsorUrl:'http://www.studergroup.com', sponsorLevel:2},
  {img:'uwflogostacked_blue.png', sponsorUrl:'http://www.uwf.edu',            sponsorLevel:2},
  {img:'wendco.png', sponsorUrl:'https://www.wendys.com/',                    sponsorLevel:2},
  {img:'west_forida_healthcare.png', sponsorUrl:'http://www.westfloridahospital.com', sponsorLevel:2},

  {img:'1620.png', sponsorUrl:'http://www.catcountry987.com',                 sponsorLevel:3},
  {img:'560-stack-y-clr-ver-b-eps.png', sponsorUrl:'http://www.coastalbankandtrust.com', sponsorLevel:3},
  {img:'app_river.png', sponsorUrl:'http://www.appriver.com',                 sponsorLevel:3},
  {img:'approved_avalex_logo_transparent.png', sponsorUrl:'http://www.avalex.com', sponsorLevel:3},
  {img:'bdilogo_black_trans.png', sponsorUrl:'http://www.baskervilledonovan.com', sponsorLevel:3},
  // {img:'bdilogo_white_trans.png',                                             sponsorLev3l:2},
  {img:'beggsandlane.png', sponsorUrl:'http://www.beggslane.com',              sponsorLevel:3},
  // {img:'beggs-&-lane.png',                                                    sponsorLev3l:2},
  {img:'bullock_tice_associates.png', sponsorUrl:'http://www.bullocktice.com', sponsorLevel:3},
  //{img:'caa_logo_final.png',                                                  sponsorLeve3:2},
  {img:'caldwell_associates.png', sponsorUrl:'www.caldwell-assoc.com',        sponsorLevel:3},
  // {img:'catcountry987.png',                                                   sponsorLev3l:2},
  {img:'catcountry.png', sponsorUrl:'http://www.catcountry987.com',           sponsorLevel:3},
  // {img:'coastal-bank-&-trust.png',                                            sponsorLevel:3},
  {img:'ecualogo.png', sponsorUrl:'http://www.ecua.fl.gov',                   sponsorLevel:3},
  {img:'exxonmobil_logo.png', sponsorUrl:'http://www.santoprene.com',         sponsorLevel:3},
  // {img:'gulfbreezenews-logo_2.png',                                           sponsorLev3l:2},
  {img:'gulfbreezenews-logo.png', sponsorUrl:'http://www.gulfbreezenews.com', sponsorLevel:3},
  {img:'hb_vert_stack_cmyk.png', sponsorUrl:'http://www.hancockbank.com',     sponsorLevel:3},
  // {img:'highpointe_hotel_logostrip.png',                                      sponsorLev3l:2},
  {img:'highpointe.png', sponsorUrl:'http://www.highpointe.com',              sponsorLevel:3},
  {img:'ims.png', sponsorUrl:'http://www.ims-expertservices.com',                    sponsorLevel:3},
  {img:'international-paper.png', sponsorUrl:'http://www.internationalpaper.com', sponsorLevel:3},
  {img:'lamar.png', sponsorUrl:'http://www.lamar.com',                        sponsorLevel:3},
  {img:'landrum.png', sponsorUrl:'http://www.LandrumHR.com',                  sponsorLevel:3},
  // {img:'lp-logo-names-flat-horizontal-20_2.png',                              sponsorLev3l:2},
  {img:'lp-logo-names-flat-horizontal-20.png', sponsorUrl:'http://www.levinlaw.com', sponsorLevel:3},
  {img:'ml.png', sponsorUrl:'http://www.ml.com',                              sponsorLevel:3},
  // {img:'newsradio.png',                                                       sponsorLevel:3},
  {img:'pete_moore_logo.png', sponsorUrl:'http://www.petemoore.com',          sponsorLevel:3},
  {img:'saltmarsh.png', sponsorUrl:'http://www.saltmarshcpa.com',             sponsorLevel:3},
  {img:'sandy-sansing.png', sponsorUrl:'http://www.sandysansing.com',         sponsorLevel:3},
  {img:'stoa-logo-vector.png', sponsorUrl:'http://www.stoaarchitects.com',    sponsorLevel:3},
  {img:'suntrust-bank-standard-color.png', sponsorUrl:'http://www.suntrust.com', sponsorLevel:3},
  {img:'terhaar-&-cronley-logo.png', sponsorUrl:'http://www.terhaarcronley.com', sponsorLevel:3},
  {img:'warren-averett.png', sponsorUrl:'http://www.warrenaverett.com',       sponsorLevel:3},
  {img:'wells_fargo.png', sponsorUrl:'http://www.wellsfargo.com',             sponsorLevel:3},

  {img:'baptist.png', sponsorUrl:'http://www.ebaptisthealthcare.org',         sponsorLevel:1},
  {img:'cox.png', sponsorUrl:'http://www.cox.com',                            sponsorLevel:1},
  {img:'gulfpower.png', sponsorUrl:'http://www.gulfpower.com',                sponsorLevel:1},
  {img:'lewis-bear-company.png', sponsorUrl:'http://www.lewisbearcompany.com/', sponsorLevel:1},
  {img:'pensacolastatecollege-color.png', sponsorUrl:'http://www.pensacolastate.edu', sponsorLevel:1},
  {img:'shhslogo4c.png', sponsorUrl:'http://www.sacred-heart.org',            sponsorLevel:1},
]
// END ADD SPONSORS

//Code that controlls the sponsor image injection in to the dom
$(function() {

  var uls=[ $('[data-sponsors="1"]'), $('[data-sponsors="2"]'), $('[data-sponsors="3"]'), $('[data-sponsors="4"]') ],
      randNum, $li, $incert, $img, $underText;

  for (var i = 0; i < SPONSORS.length; i++) {
    sponsor = SPONSORS[i];
    $incert = '';
    randNum = Math.floor(Math.random()*(90-70+1)+70)
    $img = $('<img src="imgs/sponsors/'+sponsor.img+'" class="tranparent" data-action="fade('+randNum+')">')
    $li = $('<li><span clall="topLvSponsor"></span></li>')


    if (sponsor.sponsorUrl) {$li.find('*:not(:has("*"))').append('<a href="'+sponsor.sponsorUrl+'"></a>') }

    if (sponsor.img){$li.find('*:not(:has("*"))').append($img);}

    if (sponsor.text && !sponsor.img) {$li.find('*:not(:has("*"))').append('<p class="topLvSponsor sponsor-text tranparent" data-action="fade('+randNum+')">'+sponsor.text+'</p>');}
    if (sponsor.underText && !sponsor.text){$li.find('*:not(:has("*"))').append('<p>'+sponsor.underText+'</p>')}

    $li.append($incert).append($underText)
    uls[(sponsor.sponsorLevel||4)-1].append($li);
  }
});




var pieData = [
  {label:'Distribution/Logistics',      value:30,       color:'rgba(140,178,108, 0.8)'},
  {label:'Information Technology',      value:440,      color:'rgba(157,189,129, 0.8)'},
  {label:'Manufacturing',               value:144,      color:'rgba(173,200,150, 0.8)'},
  {label:'3rd Party Administrator',     value:381,      color:'rgba(189,211,171, 0.8)'},
  {label:'Administrative HQ',           value:12,       color:'rgba(140,178,108, 0.8)'},
  {label:'Wood Manufacturing',          value:105,      color:'rgba(157,189,129, 0.8)'},
  {label:'Marine Services MRO',         value:100,      color:'rgba(173,200,150, 0.8)'},
  {label:'Offshore Pipe Manufacturer',  value:100,      color:'rgba(189,211,171, 0.8)'},
  {label:'IT/Entrepreneurial',          value:15,       color:'rgba(140,178,108, 0.8)'},
  {label:'Aviation MRO',                value:304,      color:'rgba(157,189,129, 0.8)'},
  {label:'Financial Services',          value:7200,     color:'rgba(189,211,171, 0.8)'},
];


var moneyData = {
    labels: ['$28000.00', '$42000.00', '$43000.00', '$45000.00', '$47000.00', '$54000.00', '$55000.00', '$56000.00', '$61450.00', '$70000.00', '$72000.00'],
    datasets: [
        {
            label: "My First dataset",
            fillColor: "rgba(220,220,220,0.2)",
            strokeColor: "rgba(220,220,220,1)",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: [381, 105, 100, 144, 700, 440, 100, 304, 12, 15, 200]
        }
    ]
};
animationStarted = {
  slide2:false,
  slide4a:false,
  slide4b:false,
  slide4c:false,
  slide4d:false,
  slide5:false
}



window.fade = function(el, activate, time){
  time = parseInt(time, 10) || 1000;
  $(el).animate({opacity:1}, time)
};
window.fadeOut = function(el, activate, time){
  time = parseInt(time, 10) || 1000;
  $(el).animate({opacity:0}, time)
};
window.popIn = function(el, activate, width, height){
  $(el).animate({'height':height, 'width':width}, 1000, 'easeOutBounce')
};
window.flipIn = function(el, active){
  $(el).addClass('flip-in');
}



$(function(){
  var actionableNodes = $('[data-action]');

  function action(){
    var scrollTop     = $(window).scrollTop(),
        windowHeight =  $(window).height() || 1;

    actionableNodes.each(function(index, el) {
          var distance = ($(el).offset().top - scrollTop),
              actionArr = /([\w\d_]+)\((.+)?\)/gi.exec($(el).data('action')),
              percentage = (distance / windowHeight) * 100;
              args =  actionArr[2] ? $.map(actionArr[2].split(','), function(e){ return e.trim(); }) : [50];
              args.unshift(el)

          if (actionArr && actionArr[1] in window) {
            if (args[1] >= percentage && !$(el).data('activated') ) {
              $(el).data('activated', true);
              window[actionArr[1]].apply(window, args);
            }
          }

    });
  };

  $(document).scroll(action);
});


$(function(){
    var prevSlide = $("#slide-1");
    // True if the top of the slide is at or above the middle of the screen.
    function checkSlide(slide) {
      return slide.offset().top <= ($(window).scrollTop() + $(window).height()/2);
    }

    function findSlide() {
      var slides = $("[id^=slide-]"),
      bestSlide = slides[0],
      slide,
      length = slides.length,
      i;
      for(i=0;i< length;i++){
        slide = $(slides[i]);
        if(checkSlide(slide)){
          bestSlide = slide;
        }
        else {
          break;
        }
      }
      return bestSlide;
    }

    window.setBackground = function() {
      var slide = findSlide();
      var body = $("body"),
      new_id = slide.attr('id');
      if (prevSlide.attr('id') !== new_id) {
        body.trigger(new_id)
        body.addClass(new_id);
        body.removeClass(prevSlide.attr('id'));
        location.hash = "#_" + new_id;
      };
      prevSlide = slide;
    }
    $(document).scroll(setBackground);
  }
);





//resize youtube vid on load and window resize (for mobile protrate to landscape mostly)


function staticResize(){
   window.staticWidth = $(window).width() * 0.5;
  $('#youtube').attr('width', staticWidth).attr('height', staticWidth * 0.56);
};

$(function() {
  $(document).foundation();
  staticResize();
});

$(window).on('resize', function() {
  staticResize();
});



function countUp(){
  if (!animationStarted.slide2) {
    animationStarted.slide2 = true;
    new CountUp($('#three-k')[0], 0, 8900, 0, 6, {separator : ','}).start();
  }
}


$('body').on('slide-2b', function(e){
  if (!animationStarted.slide3a) {
    animationStarted.slide3a = true;
    new Chart($('#pie')[0].getContext('2d')).Pie(pieData, {segmentShowStroke: false, responsive: true});
  }
})


$('[data-sort]').click(function(){
    var $this = $(this);
    var sortOrder = $this.data('sort')
    var colIndex = $this.index();
    var $tbody = $this.closest('table').find('tbody');
    var $rows = $tbody.find('tr');


    $rows.sort(function(a, b){
        var keyA = a.children[colIndex].innerText.toLowerCase();
        var keyB = b.children[colIndex].innerText.toLowerCase();

        if (parseInt(keyA, 10) > 0 && parseInt(keyB, 10) > 0) {
          keyA = parseInt(keyA, 10)
          keyB = parseInt(keyB, 10)
        }

        if (sortOrder === 'az') {
          var tmp = keyA
          keyA = keyB
          keyB = tmp
        }
        if(keyA < keyB) return -1;
        if(keyA > keyB) return 1;
        return 0;
    });
    $tbody.html($rows)

    if (typeof sortOrder !== 'undefined') {
      if (sortOrder === 'az') {
        $this.data('sort', 'za')
      }else if (sortOrder === 'za') {
        $this.data('sort', 'az')
      }else{
        $this.data('sort', 'az');
      }
    }else{
      $this.data('sort', 'az');
    }

});

$(function() {

  var reg = /^[^@]+@[^@]+\.[^@]+$/;
  function errOut (formArr, error){
    error = error || 'Invalid entry';
    errEl = $(this).find('[name="'+formArr.name+'"]')
    errEl.parent().next('small').remove();
    errEl.parent().addClass('error').after('<small class="error">'+error+'</small>');
    return false;
  }

  $('.thankyou-form input, .thankyou-form textarea').keyup(function(event) {
    $(this).parent().removeClass('error').next('small').remove();
  });

  $('.thankyou-form').submit(function(event) {
    that = this;
    event.preventDefault();
    var formArr = $(this).serializeArray(), passing = true;
    var email = formArr[1].value,
        name = formArr[0].value,
        subject = 'Vision 2015 Site',
        msg = formArr[2].value;
    for (var i = 0; i < formArr.length; i++) {
      if(formArr[i].value === ''){
        passing = errOut.call(this, formArr[i]);
      }
      if (formArr[i].name === 'email' && !reg.test(formArr[i].value) ) {
        passing = errOut.call(this, formArr[i], 'Invalid email');
      }
    };
    if (!passing) {return false}
    console.log('submitting ajax')
    $.ajax({
      type: "POST",
      url: "https://mandrillapp.com/api/1.0/messages/send.json",
      data: {
        'key': 'u9wCzeWj9Flau-wKEgrNpA',
        'message': {
          'from_email': email,
          'from_name': name,
          'headers': {
            'Reply-To': email
          },
          'subject': subject,
          'text': msg,
          'to': [{
            'email': 'info@pensacolachamber.com',
            'name': 'Info',
            'type': 'to'
          },
          {
            'email':'brittanym@ideaworksusa.com',
            'name': 'Brittany',
            'type': 'to'
          }]
        }
      }
    }).done(function(){
      console.log('done');
      $(that).animate({ height: 0, opacity: 0 }, 'slow', function(){
        $(that).after('<h3 class="text-center">Thank you for your interest! Someone from the Chamber will be in touch within 24 business hours. Have a great day!</h3>');
      });
    });
  });
});
